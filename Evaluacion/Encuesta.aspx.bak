<%@ Page Title="Monitoreo Cualitativo" Language="VB" AutoEventWireup="false" CodeFile="Encuesta.aspx.vb" Inherits="RevisionSocial_MonitoreoCualitativo"  MasterPageFile="~/Site.master" %>

<%@ Register Assembly="DevExpress.Web.v13.1, Version=13.1.8.0, Culture=neutral, PublicKeyToken=b88d1754d700e49a" Namespace="DevExpress.Web.ASPxPanel" TagPrefix="dx" %>

<%@ Register Assembly="DevExpress.Web.v13.1, Version=13.1.8.0, Culture=neutral, PublicKeyToken=b88d1754d700e49a" Namespace="DevExpress.Web.ASPxCallback" TagPrefix="dx" %>

<%@ Register Assembly="DevExpress.Web.v13.1, Version=13.1.8.0, Culture=neutral, PublicKeyToken=b88d1754d700e49a" Namespace="DevExpress.Web.ASPxGridView" TagPrefix="dx" %>

<%@ Register Assembly="DevExpress.Web.v13.1, Version=13.1.8.0, Culture=neutral, PublicKeyToken=b88d1754d700e49a" Namespace="DevExpress.Web.ASPxEditors" TagPrefix="dx" %>

<%@ Register Src="~/MOCA_UE.ascx" TagPrefix="uc1" TagName="MOCA_UE" %>


<asp:Content ID="cHeader" ContentPlaceHolderID="HeadContent" Runat="Server">
</asp:Content>
<asp:Content ID="cBody" ContentPlaceHolderID="MainContent" Runat="Server">
    <uc1:MOCA_UE runat="server" ID="MOCA_UE01" />
     
        <dx:ASPxPanel ID="Panel" runat="server" Width="100%" Height="600%" Border-BorderColor="Gold" Visible="true"  Scrollbars="Vertical" >
            <PanelCollection>
                <dx:PanelContent>
             
                         <br />
      

        <br />
         <p>La Escala Likert es una escala que nos permite evaluar los criterios de la siguiente manera:</p>
        <p>0. Sin comentario</p>
        <p>1. Totalmente en desacuerdo</p>
        <p>2. En desacuerdo</p>
        <p>3. Ni de acuerdo ni en desacuerdo</p>
        <p>4. De acuerdo</p>
        <p>5. Totalmente de acuerdo</p>


        <dx:ASPxGridView ID="ASPxGridView1" runat="server" AutoGenerateColumns="True" DataSourceID="SqlAplicacion" ></dx:ASPxGridView>
         
          <asp:SqlDataSource ID="SqlAplicacion" runat="server" ConnectionString="<%$ ConnectionStrings:SUEPPSConnectionString %>" SelectCommand="SELECT * FROM [AplicacionInstrumento] where IdAplicacionInstrumento= @IdAplicacionInstrumento and Activo=1">

           <SelectParameters>

               <asp:SessionParameter  Name="IdAplicacionInstrumento" />
               

            </SelectParameters>

        </asp:SqlDataSource>       


        <dx:ASPxGridView ID="GridPreguntas" runat="server" AutoGenerateColumns="False" Visible="true" DataSourceID="SqlPreguntas" KeyFieldName="IdPreguntaPorInstrumento">
            <Columns>
                <dx:GridViewDataTextColumn FieldName="IdPreguntaPorInstrumento" ReadOnly="True" VisibleIndex="0">
                    <EditFormSettings Visible="False" />
                </dx:GridViewDataTextColumn>
                <dx:GridViewDataTextColumn FieldName="IdInstrumentoDeEvaluacion" VisibleIndex="1">
                </dx:GridViewDataTextColumn>
                <dx:GridViewDataTextColumn FieldName="IdTipoDePregunta" VisibleIndex="2">
                </dx:GridViewDataTextColumn>
                <dx:GridViewDataTextColumn FieldName="NombreSeccion" VisibleIndex="3">
                </dx:GridViewDataTextColumn>
                <dx:GridViewDataTextColumn FieldName="IdTipoDeRespuesta" VisibleIndex="4">
                </dx:GridViewDataTextColumn>
                <dx:GridViewDataTextColumn FieldName="IdAmigable" VisibleIndex="5">
                </dx:GridViewDataTextColumn>
                <dx:GridViewDataTextColumn FieldName="PreguntaDeInstrumento" VisibleIndex="6">
                </dx:GridViewDataTextColumn>
                <dx:GridViewDataTextColumn FieldName="Orden" VisibleIndex="7">
                </dx:GridViewDataTextColumn>
                <dx:GridViewDataTextColumn FieldName="Requerida" VisibleIndex="8">
                </dx:GridViewDataTextColumn>
                <dx:GridViewDataTextColumn FieldName="IdSeccionFSU" VisibleIndex="9">
                </dx:GridViewDataTextColumn>

                
            </Columns>
        </dx:ASPxGridView>

        <asp:SqlDataSource ID="SqlPreguntas" runat="server" ConnectionString="<%$ ConnectionStrings:SUEPPSConnectionString %>" SelectCommand="SELECT a.IdPreguntaPorInstrumento,a.IdInstrumentoDeEvaluacion,a.IdTipoDePregunta,b.NombreSeccion,a.IdTipoDeRespuesta,a.IdAmigable,a.PreguntaDeInstrumento,a.Orden,a.Requerida,a.IdSeccionFSU FROM [PreguntasPorInstrumento] a join [SeccionesFSU] b on a.IdSeccionFSU=b.IdSeccionFSU  where a.IdInstrumentoDeEvaluacion= @IdInstrumentoDeEvaluacion and a.Activo=1 order by b.NombreSeccion, a.Orden">

           <SelectParameters>

               <asp:SessionParameter  Name="IdInstrumentoDeEvaluacion" />
               

            </SelectParameters>

        </asp:SqlDataSource>

         <dx:ASPxGridView ID="GridOpciones" runat="server" AutoGenerateColumns="False" Visible="false" DataSourceID="SqlOpcionesPreguntas" KeyFieldName="IdOpcionPreguntaPorInstrumento">
            <Columns>
                <dx:GridViewDataTextColumn FieldName="Opcion" VisibleIndex="0">
                </dx:GridViewDataTextColumn>
                <dx:GridViewDataTextColumn FieldName="IdOpcionPreguntaPorInstrumento" ReadOnly="True" VisibleIndex="1">
                </dx:GridViewDataTextColumn>
                <dx:GridViewDataTextColumn FieldName="IdPreguntaPorInstrumento" VisibleIndex="2">
                </dx:GridViewDataTextColumn>
                <dx:GridViewDataTextColumn FieldName="Valor" VisibleIndex="3">
                </dx:GridViewDataTextColumn>
                <dx:GridViewDataTextColumn FieldName="SaltaACodigo" VisibleIndex="4">
                </dx:GridViewDataTextColumn>
            </Columns>
        </dx:ASPxGridView>


        <asp:SqlDataSource ID="SqlOpcionesPreguntas" runat="server" ConnectionString="<%$ ConnectionStrings:SUEPPSConnectionString %>" SelectCommand="SELECT * FROM [OpcionesDePregunta] where IdPreguntaPorInstrumento=@Pregunta and Activo=1">

            <SelectParameters>

               <asp:SessionParameter  Name="Pregunta" />
               

            </SelectParameters>

        </asp:SqlDataSource>









            <asp:SqlDataSource ID="SqlRespuestas" runat="server" ConnectionString="<%$ ConnectionStrings:SUEPPSConnectionString %>" 
             
                 InsertCommand="INSERT INTO [RespuestasDeMonitoreoCualitativo] ([IdMonitoreoCualitativo],[IdPreguntaDeMonitoreo],[RespuestaAbierta],[RespuestaLikert],[Activo],[CreadoPor],[FechaCreacion]) VALUES (@Monitoreo, @Pregunta, @RespuestaA, @RespuestaL, 1, @Usuario, getDate()) 
                                SELECT @IdRespuestaDeMonitoreCualitativo = SCOPE_IDENTITY() "
                 OnInserted="SqlRespuestas_Inserted" >
                
                 <InsertParameters>
                      <asp:Parameter Name="Monitoreo" />
                      <asp:Parameter Name="Pregunta" />
                     <asp:Parameter Name="RespuestaA" />
                     <asp:Parameter Name="RespuestaL" />
                      <asp:Parameter Direction="Output" Name="IdRespuestaDeMonitoreCualitativo" Type="Int32" />
                     <asp:SessionParameter Name="Usuario" />
                 </InsertParameters>
          </asp:SqlDataSource>


             <asp:SqlDataSource ID="SqlRespuestasOpciones" runat="server" ConnectionString="<%$ ConnectionStrings:SUEPPSConnectionString %>" ></asp:SqlDataSource>

     
        

       

    
                </dx:PanelContent>
            </PanelCollection>

<Border BorderColor="Gold"></Border>

        </dx:ASPxPanel>

</asp:Content>